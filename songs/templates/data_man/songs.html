{% extends "data_man/base.html" %}

{% load escape_quotes %}

{% block body %}
        <br>
        <h2>Songs</h2>
        <form method="GET" onsubmit="return false;" id="form_data_man_search_song">
            {% csrf_token %}
            <input type="text" class="form-control" placeholder="search song / artist / album / genre" id="search_song_key_word" onkeyup="data_man_search_song()" />
        </form>
        <br>
        <table class="table table-striped table-hover">
            <tr>
                <td></td>
                <th>Title</th>
                <th>Artist</th>
                <th>Album</th>
                <th>Genre</th>
                <th>Duration</th>
                <th>Size</th>
                <th>File Format</th>
            </tr>
            <tbody id="tbody_data_man_songs">
                {% for song in songs %}
                    <tr id="song_tr_{{ forloop.counter }}">
                        <td>{{ forloop.counter }}</td>
                        <td><span id="song_title_{{ forloop.counter }}">{{ song }}</span><input type="hidden" value="{{ song.path }}" id="song_path_{{ forloop.counter }}"></td>
                        <td id="song_artist_{{ forloop.counter }}">{{ song.album.artist }}</td>
                        <td id="song_album_{{ forloop.counter }}">{{ song.album }}</td>
                        <td id="song_genre_{{ forloop.counter }}">
                            {% for genre in song.genre.all %}  
                                {{ genre }};
                            {% endfor %}
                        </td>
                        <td>{{ song.duration }} mins</td>
                        <td>{{ song.size }} MB </td>
                        <td>{{ song.audio_format }}</td>
                    </tr>
                {% empty %}
                    <p class="alert alert-warning">No songs retrieved.</p>
                {% endfor %}
            </tbody>
            
        </table>
    </div>

    <!-- The Modal -->
 <div class="modal fade" id="myModal">
    <div class="modal-dialog">
      <div class="modal-content">
      
        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title">Modal Heading</h4>
          <button type="button" class="close" data-dismiss="modal">Ã—</button>
        </div>
        
        <!-- Modal body -->
        <div class="modal-body">
            <div id="div_ass_song">
                <h2>Add Song</h2>
                <form class="form" id="form_add_song" method="POST">
                    {% csrf_token %}
                    <div class="form-group">
                      <label for="title">Title:</label>
                      <input type="text" name="title" id="title" class="form-control">
                    </div>
                    <div class="form-group">
                        <label>Album:</label>
                        <select required name="album" id="album" class="form-control">
                            {% for album in albums %}
                                <option value="{{ album.id }}">{{ album }} - {{ album.artist }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Genre:</label>
                        <select required multiple name="genres" id="genres" class="form-control">
                            {% for genre in genres %}
                                <option value="{{ genre.id }}">{{ genre }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Path:</label>
                        <input type="file" name="path" id="path" required class="form-control"  accept="audio/*"/>
                        <br>
                        <button class="btn btn-primary">Submit</button>
                    </div>
                  </form>
                  <audio id="audio_to_upload" src=""></audio><div class="hidden"></div>
            </div>
        </div>        
      </div>
    </div>
  </div>
{% endblock %}